<div id="archives">
    <% const pageType=page.type; let posts=[]; if (pageType) { posts=site.posts.filter(post=> {
        return post.categories && post.categories.some(cat => cat.name === pageType);
        }).sort('-date');
        }
        %>

        <% if (page.content && page.content.trim()) { %>
            <div class="page-content">
                <%- page.content %>
            </div>
            <% } %>

                <% if (posts.length> 0) { %>
                    <% posts.forEach((post)=> { %>
                        <div class="timeline">
                            <div class="timeline-tail"></div>
                            <div class="timeline-content">
                                <div class="item-time">
                                    <%= date(post.date, "YYYY/M/D" ) %>
                                </div>
                                <a href="<%- url_for(post.path) %>">
                                    <h3>
                                        <%= post.title %>
                                    </h3>
                                </a>
                                <div class="info">
                                    <% if (post.categories && post.categories.data.length !==0) { %>
                                        <span class="category">
                                            <a href="<%- url_for(post.categories.data[0].path) %>">
                                                <span class="icon">
                                                    <i class="fa-solid fa-bookmark fa-fw"></i>
                                                </span>
                                                <%= post.categories.data[0].name %>
                                            </a>
                                        </span>
                                        <% } %>

                                            <% if (pageType==='projects' && post.status) { %>
                                                <span class="project-status">
                                                    <%= post.status %>
                                                </span>
                                                <% } %>

                                                    <% if (post.repo) { %>
                                                        <span class="repo-link">
                                                            <a href="<%= post.repo %>" target="_blank" rel="noopener">
                                                                <span class="icon">
                                                                    <i class="fa-brands fa-github fa-fw"></i>
                                                                </span>
                                                                Repo
                                                            </a>
                                                        </span>
                                                        <% } %>

                                                            <% if (post.tags && post.tags.data.length !==0) { %>
                                                                <span class="tags">
                                                                    <span class="icon">
                                                                        <i class="fa-solid fa-tags fa-fw"></i>
                                                                    </span>
                                                                    <% let prev; %>
                                                                        <% post.tags.data.forEach((tag)=> { %>
                                                                            <span class="tag">
                                                                                <% const
                                                                                    colors=theme.colors.filter((color)=>
                                                                                    color !== prev);
                                                                                    let id = Math.floor(Math.random() *
                                                                                    colors.length);
                                                                                    prev = colors[id];
                                                                                    %>
                                                                                    <a href="<%- url_for(tag.path) %>"
                                                                                        style="color: <%- colors[id] %>">
                                                                                        <%= tag.name %>
                                                                                    </a>
                                                                            </span>
                                                                            <% }); %>
                                                                </span>
                                                                <% } %>
                                </div>
                            </div>
                        </div>
                        <% }); %>
                            <% } else { %>
                                <div class="no-posts">
                                    <p>No posts in this category yet.</p>
                                </div>
                                <% } %>
</div>